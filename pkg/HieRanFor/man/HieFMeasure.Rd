% Generated by roxygen2 (4.1.0): do not edit by hand
% Please edit documentation in R/HieFMeasure.R
\name{HieFMeasure}
\alias{HieFMeasure}
\title{Hierarchical precision, hierarchical recall and hierarchical F measure}
\usage{
HieFMeasure(conf.matr, unique.path, beta.h.F = 1, by.node = FALSE, ...)
}
\arguments{
\item{conf.matr}{Object of class \code{"confusionMatrix"}, as generated
   by \code{\link{confusionMatrix}} function of the '\code{caret}' package.}

\item{unique.path}{Data frame, the \code{unique.path} data frame from
   \code{RunHRF}. Can be found in an object of class \code{"HRF"} at
   \code{$hier.struc$unique.path}.}

\item{beta.h.F}{Numeric in the range \code{beta.h.F}>=0. Controls the
   relative weight of Hierarchical precision and hierarchical recall in the
   estimation of hierarchical F measure. Values close to 0 will give higher
   weight to Hierarchical precision. Equal weights are for \code{beta.h.F}=1,
   while values above 1 will give higher weight to hierarchical recall. See
   details in \emph{Kiritchenko et al. (2005)}.}

\item{by.node}{Logical, if \code{TRUE}, the hierarchical precision,
   recall and F measure are estimated for each class as well.}

\item{\dots}{Optional parameters to be passed to low level functions.}
}
\value{
a data frame with the name of the measure in the first column and
     the value in the second.
}
\description{
This function estimate 3 measures of accuracy that accounts for the
 hierarchical structure of the class hierarchy.
}
\details{
To create a confusion matric in with the \code{caret} package, the
   levels of the observed and predicted vectors should be identical.
   Therefore, we advise using \code{\link{JoinLevels}}.  \emph{Kiritchenko
   et al. (2005)} estimated the hierarchical precision, recall and F
   measure by summing over all cases. Here, we estimate the same values
   directly from the confusion matrix. In addition, \emph{Kiritchenko et al.
   (2005)} do not provide a class specific measure of hierarchical accuracy.
   Here we developed one such measure. \cr
   In the hierarchical measures of accuracy, not all misclassifications carry
   the same weight. For example, in the simple hierarchy below, correct
   classification of a case from class \emph{A.1} will contribute most to the
   overall accuracy (2 in this case). However, misclassification of the
   \emph{A.1} case to class \emph{A.2} will still contribute to the overall
   accuracy since \emph{A.1} and \emph{A.2} share one node in their path
   (\emph{A}). On the other hand, misclassification of the \emph{A.1} case to
   class \emph{B.2} will not contribute anything to the overall accuracy,
   since the two terminal nodes only meet at the tree root of the class
   hierarchy.

 \if{html}{\figure{SimpleHie.jpeg}}
 \if{latex}{\figure{SimpleHie.jpeg}{options: width=7cm}}
}
\section{hP, hR and hF}{

 The hierarchical precision (\emph{hP}), recall (\emph{hR}) and F measure
 (\emph{hF}) are estimated from a confusion matrix (with \emph{j} being the
 observed class and \emph{k} being the predicted class) using the formulas
 given below. Similarly, the hierarchical precision for predicted class
 \emph{k} (\emph{hP [k]}), the hierarchical recall for observed class
 \emph{j} (\emph{hR [j]}), and the hierarchical F measure for class
 \emph{j=k} (\emph{hF [j=k]}) can also be estimated from the confusion
 matrix. The \code{by.node} specific measures converge to the regular flat
 precision and recall (respectively) by setting \emph{S [j,k] = 1} if \emph{j
 = k} and \emph{S [j,k] = 0} if \emph{j} differs from \emph{k}.

 \if{html}{\figure{Fmeasures.jpg}}
 \if{latex}{\figure{Fmeasures.jpg}{options: width=7cm}}
}
\examples{
data(OliveOilHie)
hie.RF.OO <- RunHRF(train.data        = OliveOilHie,
                    case.ID           = "case.ID",
                    hie.levels        = c(2:4),
                    mtry              = "tuneRF2",
                    internal.end.path = TRUE)

# extract the crisp class using PerformanceHRF
perf.hRF.OO <- PerformanceHRF(hie.RF     = hie.RF.OO,
                              per.index  = c("hie.F.measure"),
                              crisp.rule = c("stepwise.majority"))
crisp.OO <- perf.hRF.OO$crisp.case.class

# Join factor levels of the observed and predicted
joined.levels <- JoinLevels(vector.1 = crisp.OO$stepwise.majority.rule,
                            vector.2 = crisp.OO$obs.term.node)

# create the confusionMatrix object
library(caret)
conf.matr <- confusionMatrix(data      = joined.levels$vector.1,
                             reference = joined.levels$vector.2,
                             dnn       = c("Prediction", "Observed"))

# the HieFMeasure
hie.F.value <- HieFMeasure(conf.matr   = conf.matr,
                           unique.path = hie.RF.OO$hier.struc$unique.path,
                           beta.h.F    = 1,
                           by.node     = TRUE)

# compare to the output of PerformanceHRF
hie.performance <- perf.hRF.OO$hie.performance
}
\author{
Yoni Gavish <gavishyoni@gmail.com>
}
\references{
Kiritchenko, S., S. Matwin, and F. Famili. 2005. Functional annotation of
   genes using hierarchical text categorization. In: \emph{Proc. of the ACL
   Workshop on Linking Biological Literature, Ontologies and Databases:
   Mining Biological Semantics}.
}

